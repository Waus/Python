Potrzebuję przetworzyć dane w formacie CSV. Dane te zawierają 30 pól, są one pooddzielane średnikami. Przetwórz mi każdą linię w następujący sposób:
1. W polu nr 5 wstaw tekst '" &X.WYSZUKAJ("#5";'Lista identyfikatorów'!$A$2:$A$100;'Lista identyfikatorów'!$C$2:$C$100;FAŁSZ) & "' (bez dwóch najbardziej zewnętrznych apostrofów), chyba że wartość w tym polu to '3000-01-01', '2000-12-31' albo null to wtedy nie podmieniaj.
2. W ostatnim polu (#30) wstaw tekst '" &X.WYSZUKAJ("#7";'Lista identyfikatorów'!$A$2:$A$100;'Lista identyfikatorów'!$C$2:$C$100;FAŁSZ)' (bez dwóch najbardziej zewnętrznych apostrofów).
3. We wszystkich liniach dopisz na początku '= "' (bez zewnętrznych apostrofów).

Jeżeli ilość danych do przetworzenia jest za duża, to rozbij odpowiedź na kilka wiadomości.

Oto dane do przetworzenia:

Brak udziału uprawnionego w danym typie udziału.;Ostrzeżenie;;2021-01-01;2022-01-26;218;Telewizja Polska Spółka Akcyjna;1115;1;wszystkie pola eksploatacji;4;publiczne odtwarzanie;1447;Wiesław Rutowicz;12;07 zgłoś się;Przerwany urlop;21;244,7363;0,0000;146,8281;2,0000;2,0000;40,3497;20,1751;8,9667;8,9667;13,4500;2,0000;muranski
Niepoprawna wartość.;Błąd;;1900-01-02;3000-01-01;218;;1115;1;;4;;1447;;12;;;;238,7363;0,0000;146,8281;0,0000;0,0000;40,3497;20,1751;8,9667;8,9667;13,4500;0,0000;muranski
Niepoprawna wartość.;Błąd;;2050-12-31;2000-12-31;218;;1115;1;;4;;1447;;12;;;;238,7363;0,0000;146,8281;0,0000;0,0000;40,3497;20,1751;8,9667;8,9667;13,4500;0,0000;muranski
Niepoprawna wartość.;Błąd;;2021-01-01;Invalid date;218;;1115;1;;4;;1447;;12;;;;238,7363;0,0000;146,8281;0,0000;0,0000;40,3497;20,1751;8,9667;8,9667;13,4500;0,0000;muranski
Niepoprawna wartość.;Błąd;;1899-12-31;2999-12-31;218;;1115;1;;4;;1447;;12;;;;238,7363;0,0000;146,8281;0,0000;0,0000;40,3497;20,1751;8,9667;8,9667;13,4500;0,0000;muranski
Niepoprawna wartość.;Błąd;;0001-01-01;2022-01-26;218;;1115;1;;4;;1447;;12;;;;238,7363;0,0000;146,8281;0,0000;0,0000;40,3497;20,1751;8,9667;8,9667;13,4500;0,0000;muranski
Nieprawidłowy status uprawnionego.;Błąd;;2021-01-01;2022-01-26;218;;1115;1;;4;;171;;12;;;;238,7363;0,0000;146,8281;0,0000;0,0000;40,3497;20,1751;8,9667;8,9667;13,4500;0,0000;muranski
Niepoprawna wartość.;Błąd;;2021-01-01;2022-01-26;218;;1115;1;;7;;1447;;12;;;;238,7363;0,0000;146,8281;0,0000;0,0000;40,3497;20,1751;8,9667;8,9667;13,4500;0,0000;muranski
Brak użytkownika w bazie dla tego kontraktu.;Błąd;;2021-01-01;2022-01-26;6;;1115;1;;4;;1447;;12;;;;238,7363;0,0000;146,8281;0,0000;0,0000;40,3497;20,1751;8,9667;8,9667;13,4500;0,0000;muranski
Niepoprawna wartość.;Błąd;;2021-01-01;2022-01-26;218;;1115;1;;4;;1447;;510981;;;;238,7363;0,0000;146,8281;0,0000;0,0000;40,3497;20,1751;8,9667;8,9667;13,4500;0,0000;muranski
Niepoprawna wartość.;Błąd;;2021-01-01;2022-01-26;218;;1115;1;;4;;100000;;12;;;;238,7363;0,0000;146,8281;0,0000;0,0000;40,3497;20,1751;8,9667;8,9667;13,4500;0,0000;muranski
Niepoprawna wartość.;Błąd;;2021-01-01;2022-01-26;218;;12;1;;4;;1447;;12;;;;238,7363;0,0000;146,8281;0,0000;0,0000;40,3497;20,1751;8,9667;8,9667;13,4500;0,0000;muranski
Niepoprawna wartość.;Błąd;;2021-01-01;2022-01-26;218;;1115;1000;;4;;1447;;12;;;;238,7363;0,0000;146,8281;0,0000;0,0000;40,3497;20,1751;8,9667;8,9667;13,4500;0,0000;muranski
Kwota powinna być dodatnia.;Błąd;;2021-01-01;2022-01-26;218;;1115;1;;4;;1447;;12;;;;-1,0000;-2,0000;-3,0000;-4,0000;-5,0000;-6,0000;-7,0000;-8,0000;-9,0000;-10,0000;-11,0000;muranski
Stan poprawny jedynie dla użyć kinowych.;Ostrzeżenie;;2021-01-01;2022-01-26;218;Telewizja Polska Spółka Akcyjna;1115;1;wszystkie pola eksploatacji;4;publiczne odtwarzanie;1447;Wiesław Rutowicz;12;07 zgłoś się;Przerwany urlop;21;238,7363;0,0000;0,0000;0,0000;0,0000;0,0000;0,0000;0,0000;0,0000;0,0000;0,0000;muranski
Kwota na autorów powinna być równa sumie poszczególnych pozycji autorskich.;Ostrzeżenie;;2021-01-01;2022-01-26;218;Telewizja Polska Spółka Akcyjna;1115;1;wszystkie pola eksploatacji;4;publiczne odtwarzanie;1447;Wiesław Rutowicz;12;07 zgłoś się;Przerwany urlop;21;238,7363;0,0000;0,0000;0,0000;0,0000;0,0000;0,0000;0,0000;0,0000;0,0000;0,0000;muranski
Kwota na autorów powinna być równa sumie poszczególnych pozycji autorskich.;Błąd;;2021-01-01;2022-01-26;218;;1115;1;;4;;1447;;12;;;;238,7363;0,0000;1,0000;0,0000;0,0000;2,0000;3,0000;4,0000;5,0000;6,0000;0,0000;muranski
Kwota na autorów dotyczy tylko udziałów autorskich.;Błąd;;2021-01-01;2022-01-26;218;;1115;1;;4;;1447;;12;;;;238,7363;1,0000;146,8281;0,0000;0,0000;40,3497;20,1751;8,9667;8,9667;13,4500;0,0000;muranski
Brak uprawnionego w udziałach na danym utworze.;Ostrzeżenie;;2021-01-01;2022-01-26;218;Telewizja Polska Spółka Akcyjna;1115;1;wszystkie pola eksploatacji;4;publiczne odtwarzanie;1448;Jerzy Stawicki;12;07 zgłoś się;Przerwany urlop;21;238,7363;0,0000;146,8281;0,0000;0,0000;40,3497;20,1751;8,9667;8,9667;13,4500;0,0000;muranski
Nie znalazłem udziału dla uprawnionego.;Ostrzeżenie;;2021-01-01;2022-01-26;218;Telewizja Polska Spółka Akcyjna;1115;2;utrwalania;4;publiczne odtwarzanie;1447;Wiesław Rutowicz;12;07 zgłoś się;Przerwany urlop;21;238,7363;0,0000;146,8281;0,0000;0,0000;40,3497;20,1751;8,9667;8,9667;13,4500;0,0000;muranski